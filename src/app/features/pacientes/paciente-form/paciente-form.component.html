<div class="paciente-form-container">
  <h1>{{isEditMode ? 'Editar' : 'Nuevo'}} Paciente</h1>

  <form [formGroup]="pacienteForm" (ngSubmit)="onSubmit()" class="form-grid">
    <!-- Datos del Paciente -->
    <mat-card class="form-section">
      <mat-card-header>
        <mat-card-title>Datos del Paciente</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Nombre de la Mascota</mat-label>
            <input matInput formControlName="nombreMascota" placeholder="Nombre de la mascota">
            <mat-error *ngIf="pacienteForm.get('nombreMascota')?.hasError('required')">
              El nombre es requerido
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Especie</mat-label>
            <mat-select formControlName="especie">
              <mat-option *ngFor="let especie of especies" [value]="especie">
                {{especie}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="pacienteForm.get('especie')?.hasError('required')">
              La especie es requerida
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Raza</mat-label>
            <input matInput formControlName="raza" placeholder="Raza de la mascota">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Fecha de Nacimiento</mat-label>
            <input matInput type="date" formControlName="fechaNacimiento">
            <mat-error *ngIf="pacienteForm.get('fechaNacimiento')?.hasError('required')">
              La fecha de nacimiento es requerida
            </mat-error>
          </mat-form-field>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Datos del Dueño -->
    <mat-card class="form-section">
      <mat-card-header>
        <mat-card-title>Datos del Dueño</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Tipo de Identificación</mat-label>
            <mat-select formControlName="tipoIdentificacionDueno">
              <mat-option value="CC">CC</mat-option>
              <mat-option value="CE">CE</mat-option>
              <mat-option value="PASAPORTE">PASAPORTE</mat-option>
            </mat-select>
            <mat-error *ngIf="pacienteForm.get('tipoIdentificacionDueno')?.hasError('required')">
              El tipo de identificación es requerido
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Número de Identificación</mat-label>
            <input matInput formControlName="identificacionDueno" placeholder="Número de identificación" (blur)="onIdentificacionDuenoBlur()">
            <mat-error *ngIf="pacienteForm.get('identificacionDueno')?.hasError('required')">
              La identificación es requerida
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Nombre del Dueño</mat-label>
            <input matInput formControlName="nombreDueno" placeholder="Nombre completo del dueño">
            <mat-error *ngIf="pacienteForm.get('nombreDueno')?.hasError('required')">
              El nombre del dueño es requerido
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Ciudad</mat-label>
            <input matInput formControlName="ciudad" placeholder="Ciudad de residencia">
            <mat-error *ngIf="pacienteForm.get('ciudad')?.hasError('required')">
              La ciudad es requerida
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Dirección</mat-label>
            <input matInput formControlName="direccion" placeholder="Dirección completa">
            <mat-error *ngIf="pacienteForm.get('direccion')?.hasError('required')">
              La dirección es requerida
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Teléfono</mat-label>
            <input matInput formControlName="telefono" placeholder="Número de teléfono">
            <mat-error *ngIf="pacienteForm.get('telefono')?.hasError('required')">
              El teléfono es requerido
            </mat-error>
            <mat-error *ngIf="pacienteForm.get('telefono')?.hasError('pattern')">
              Formato de teléfono inválido
            </mat-error>
          </mat-form-field>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Botones de Acción -->
    <div class="form-actions">
      <button mat-button type="button" (click)="cancelar()">Cancelar</button>
      <button mat-raised-button color="primary" type="submit">
        {{isEditMode ? 'Actualizar' : 'Guardar'}}
      </button>
    </div>
  </form>
</div> 